<div class="scrap-calculator-container">
  <div class="scrap-calculator-card">
    <h2>ğŸ’ Bozma FiyatÄ± Hesaplama</h2>
    <p class="description">Gram ve ayar bilgisi ile altÄ±n bozma fiyatÄ±nÄ± hÄ±zlÄ±ca hesaplayÄ±n</p>
    
    <!-- Gold Price Info -->
    <div *ngIf="goldPrice" class="gold-price-info">
      <div class="price-header">
        <span class="price-label">ğŸ’° AltÄ±n AlÄ±ÅŸ Kuru:</span>
        <span class="price-value">{{ formatPrice(goldPrice.buying) }}/gram</span>
        <button 
          class="btn-refresh" 
          (click)="refreshGoldPrice()" 
          [disabled]="isLoadingPrice"
          title="Kuru yenile">
          ğŸ”„
        </button>
      </div>
      <div class="price-timestamp">
        {{ getCacheStatus() }}
        <span class="mock-warning" *ngIf="!isRealApiData">âš ï¸ Demo veri</span>
      </div>
    </div>

    <div class="calculator-form">
      <div class="input-row">
        <div class="form-group">
          <label for="productType">ÃœrÃ¼n Tipi</label>
          <select id="productType" [(ngModel)]="productType" class="form-control">
            <option value="elizi">Elizi ÃœrÃ¼nÃ¼</option>
            <option value="diger">DiÄŸer ÃœrÃ¼n</option>
          </select>
        </div>

        <div class="form-group">
          <label for="quickGram">Gram</label>
          <input 
            type="number" 
            id="quickGram" 
            [(ngModel)]="quickGram"
            class="form-control"
            placeholder="Ã–rn: 10"
            step="0.01"
            min="0.01"
          >
        </div>

        <div class="form-group">
          <label for="quickAyar">Ayar</label>
          <select id="quickAyar" [(ngModel)]="quickAyar" class="form-control">
            <option [ngValue]="8">8 ayar</option>
            <option [ngValue]="10">10 ayar</option>
            <option [ngValue]="14">14 ayar</option>
            <option [ngValue]="18">18 ayar</option>
            <option [ngValue]="21">21 ayar</option>
            <option [ngValue]="22">22 ayar</option>
          </select>
        </div>
      </div>

      <div class="button-group">
        <button 
          type="button" 
          class="btn btn-primary"
          (click)="calculateQuickScrap()"
          [disabled]="!quickGram || quickGram <= 0 || !goldPrice">
          Bozma FiyatÄ±nÄ± Hesapla
        </button>
        <button type="button" class="btn btn-secondary" (click)="reset()">
          Temizle
        </button>
      </div>
    </div>

    <div *ngIf="quickScrapResult" class="result-card">
      <h3>Hesaplama Sonucu</h3>
      <div class="result-details">
        <div class="result-item">
          <span class="label">ÃœrÃ¼n Tipi:</span>
          <span class="value">{{ quickScrapResult.productType === 'elizi' ? 'Elizi ÃœrÃ¼nÃ¼' : 'DiÄŸer ÃœrÃ¼n' }}</span>
        </div>
        <div class="result-item">
          <span class="label">Gram:</span>
          <span class="value">{{ quickScrapResult.gram }} g</span>
        </div>
        <div class="result-item">
          <span class="label">Ayar:</span>
          <span class="value">{{ quickScrapResult.ayar }} ayar</span>
        </div>
        <div class="result-item">
          <span class="label">Ayar KatsayÄ±sÄ±:</span>
          <span class="value">{{ quickScrapResult.katsayi }}</span>
        </div>
        <div class="result-item">
          <span class="label">AltÄ±n AlÄ±ÅŸ FiyatÄ±:</span>
          <span class="value">{{ formatPrice(quickScrapResult.alisFiyat) }}/g</span>
        </div>
        <div class="result-total">
          <span class="label">Bozma FiyatÄ±:</span>
          <span class="value price">{{ formatPrice(quickScrapResult.toplamFiyat) }}</span>
        </div>
      </div>

      <div class="formula-info">
        <p><strong>FormÃ¼l:</strong> Gram Ã— Ayar KatsayÄ±sÄ± Ã— AltÄ±n AlÄ±ÅŸ FiyatÄ±</p>
        <p class="formula-detail">
          {{ quickScrapResult.gram }} Ã— {{ quickScrapResult.katsayi }} Ã— {{ formatPrice(quickScrapResult.alisFiyat) }}
        </p>
      </div>
    </div>

    <!-- Calculation History -->
    <div *ngIf="calculationHistory.length > 0" class="history-section">
      <div class="history-header">
        <h3>ğŸ“‹ Son Hesaplamalar</h3>
        <button type="button" class="btn-clear-history" (click)="clearHistory()" title="GeÃ§miÅŸi Temizle">
          ğŸ—‘ï¸ Temizle
        </button>
      </div>
      
      <div class="history-list">
        <div *ngFor="let item of calculationHistory; let i = index" class="history-item">
          <div class="history-item-header">
            <span class="history-index">#{{ i + 1 }}</span>
            <span class="history-time">{{ formatDate(item.timestamp) }}</span>
          </div>
          <div class="history-item-details">
            <span class="detail">
              <strong>{{ item.productType === 'elizi' ? 'Elizi' : 'DiÄŸer' }}</strong>
            </span>
            <span class="detail">{{ item.gram }}g</span>
            <span class="detail">{{ item.ayar }} ayar</span>
            <span class="detail">({{ item.katsayi }})</span>
            <span class="detail price-highlight">{{ formatPrice(item.toplamFiyat) }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
